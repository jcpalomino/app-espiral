<ion-view>
    <ion-nav-title>{{ title }}</ion-nav-title>
    <ion-content padding="true" mm-state-class>
        <ion-refresher pulling-text="{{ 'mm.core.pulltorefresh' | translate }}" on-refresh="doRefresh()" ng-if="certificateLoaded"></ion-refresher>
        <mm-loading hide-until="certificateLoaded">
            <mm-course-mod-description description="description"></mm-course-mod-description>

            <div class="card" ng-if="issues.length > 0">
                <div class="item item-divider">{{ 'mma.mod_certificate.summaryofattempts' | translate }}</div>
                <div class="item" ng-repeat="issue in issues">
                    <p class="item-heading">{{ issue.timecreated * 1000 | mmFormatDate:"dfmediumdate" }}</p>
                    <p ng-if="issue.grade">{{ issue.grade }}</p>
                </div>
            </div>

            <button ng-if="!certificate.requiredtimenotmet && issues.length > 0" ng-click="openCertificate()" class="button button-block">
                <i class="icon ion-download"></i> {{ 'mma.mod_certificate.getcertificate' | translate }}
            </button>

            <p ng-if="certificate.requiredtimenotmet">{{ 'mma.mod_certificate.requiredtimenotmet' | translate:{$a: certificate} }}</p>
        </mm-loading>
    </ion-content>
</ion-view>